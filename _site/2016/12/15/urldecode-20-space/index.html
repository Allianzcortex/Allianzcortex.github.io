<!DOCTYPE html>

<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>A Problem about urlencode,space and 20%</title>
  <meta name="description" content="So when url is encoded/decoded, when to use + and when to use %20? 这篇文章对应的中文版 Background In short, this is the case. The mobile application logs of company is collected by Nginx. Encode with urlencode. tricky method is to us tail -F | grep *** to find the target line and then parse it with pratical tools, but recently we have to deal with the logs, so there must be one way to do it automatically. gland to find method on StackOverFlow, so directly import urllib. Unquote to the code . Development But soon something wrong happened, if the time format given is 2016-12-15 12:02:22, the result after processing is formatted as 2016-12-15+12:02:22. It’s impossible to sort by the time of the recent occurrence, even the most basic search functions will be a big problem,let alone further processing. What Happened There is still discussion about this problem on SO，and quote the wikipedia： When data that has been entered into HTML forms is submitted, the form field names and values are encoded and sent to the server in an HTTP request message using method GET or POST, or, historically, via email.[2] The encoding used by default is based on an early version of the general URI percent-encoding rules,[3] with a number of modifications such as newline normalization and replacing spaces with + instead of %20. The media type of data encoded this way is application/x-www-form-urlencoded, and it is currently defined (still in a very outdated manner) in the HTML and XForms specifications. In addition, the CGI specification contains rules for how web servers decode data of this type and make it available to applications. When HTML form data is sent in an HTTP GET request, it is included in the query component of the request URI using the same syntax described above. When sent in an HTTP POST request or via email, the data is placed in the body of the message, and application/x-www-form-urlencoded is included in the message’s Content-Type header. The reason for this is that the URL encoding is divided into two parts: the old-fashioned application/x-www-form-url encoded spaces are represented as + and + is represented as %2B. For example, search for “Python urlencode+20” in Google, and the query url is https://www.google.com/search?q=Python+urlencode%2B20 As for the HTTP URLs of modern urls, spaces are encoded as %20 and + is not encoded. In the given log, the space is still passed as “+”, and unquote() is decoded in a modern way, so the result is different. The solution is to use the raw_data.replace(&#39;+&#39;, &#39;%20&#39;) to convert the space back before decoding (because the log contains no + in the content, so this will not affect the expressiveness of the log). For various correspondences in urlencode encoding, you can refer to this Link.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/2016/12/15/urldecode-20-space/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Allianzcortex-Blog" href="http://localhost:4000/feed.xml">

  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="hzcortex">
  <meta name="twitter:title" content="A Problem about urlencode,space and 20%">
  <meta name="twitter:description" content="So when url is encoded/decoded, when to use + and when to use %20? 这篇文章对应的中文版 Background In short, this is the case. The mobile application logs of company is collected by Nginx. Encode with urlenc...">
  
    <meta name="twitter:creator" content="hzcortex">
  
  

  <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Bitter:400,700,400italic:latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Allianzcortex-Blog</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
        
        <a class="page-link" href="/projects/">Projects</a>
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/board/">board</a>
      
        
        <a class="page-link" href="/feed.xml">RSS</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">A Problem about urlencode,space and 20%</h1>
    
    <p class="post-meta"><time datetime="2016-12-15T13:59:20-04:00" itemprop="datePublished">Dec 15, 2016</time> • 
  
  

</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>So when url is encoded/decoded, when to use + and when to use %20?
<!-- more --></p>

<p><a href="/../translation/2016-12-15-urldecode-20-space.html">这篇文章对应的中文版</a></p>

<hr />

<h4 id="background">Background</h4>

<p>In short, this is the case. The mobile application logs of company is collected by Nginx.
Encode with <code class="highlighter-rouge">urlencode</code>. tricky method is to us <code class="highlighter-rouge">tail -F | grep ***</code> to find the target line and then parse it with pratical tools, but recently we have to deal with the logs, so there must be one way to do it automatically. gland to find <a href="http://stackoverflow.com/questions/28431359/how-to-decode-a-url-encoded-string-in-python">method</a> on <strong>StackOverFlow</strong>, so directly import <code class="highlighter-rouge">urllib. Unquote</code> to the code .</p>

<h4 id="development">Development</h4>

<p>But soon something wrong happened, if the time format given is <code class="highlighter-rouge">2016-12-15 12:02:22</code>, the result after processing is formatted as
<code class="highlighter-rouge">2016-12-15+12:02:22</code>. It’s impossible to sort by the time of the recent occurrence, even the most basic search functions will be a big problem,let alone further processing.</p>

<h4 id="what-happened">What Happened</h4>

<p>There is still <a href="http://stackoverflow.com/questions/1634271/url-encoding-the-space-character-or-20">discussion</a> about this problem on SO，and quote the wikipedia：</p>

<blockquote>
  <p>When data that has been entered into HTML forms is submitted, the form field names and values are encoded and sent to the server in an HTTP request message using method GET or POST, or, historically, via email.[2] The encoding used by default is based on an early version of the general URI percent-encoding rules,[3] with a number of modifications such as newline normalization and replacing spaces with + instead of %20. The media type of data encoded this way is application/x-www-form-urlencoded, and it is currently defined (still in a very outdated manner) in the HTML and XForms specifications. In addition, the CGI specification contains rules for how web servers decode data of this type and make it available to applications.
When HTML form data is sent in an HTTP GET request, it is included in the query component of the request URI using the same syntax described above. When sent in an HTTP POST request or via email, the data is placed in the body of the message, and application/x-www-form-urlencoded is included in the message’s Content-Type header.</p>
</blockquote>

<p>The reason for this is that the URL encoding is divided into two parts: the old-fashioned <strong>application/x-www-form-url encoded spaces</strong> are represented as + and + is represented as <strong>%2B</strong>. For example, search for “Python urlencode+20” in Google, and the query url is <code class="highlighter-rouge">https://www.google.com/search?q=Python+urlencode%2B20</code></p>

<p>As for the HTTP URLs of modern urls, spaces are encoded as <strong>%20</strong> and + is not encoded.</p>

<p>In the given log, the space is still passed as “+”, and unquote() is decoded in a modern way, so the result is different. The solution is to use the <code class="highlighter-rouge">raw_data.replace('+', '%20')</code> to convert the space back before decoding (because the log contains no + in the content, so this will not affect the expressiveness of the log).</p>

<p>For various correspondences in urlencode encoding, you can refer to this <a href="http://www.degraeve.com/reference/urlencoding.php">Link</a>.</p>

  </div>

</article>

        
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'allianzcortex-me'; // required: replace example with your forum shortname
        // var disqus_developer = 1; // Comment out when the site is live
        var disqus_identifier = "/2016/12/15/urldecode-20-space/";

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </main>
    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

Pro Land
    </p>

  </div>

</footer>


  </body>

</html>
