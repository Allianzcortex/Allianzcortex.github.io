<!DOCTYPE html>

<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Improve Java Project Performace 20 times ！</title>
  <meta name="description" content="Recently, I completed the first Assignment of Business Development. The teacher has already publish the course requirements to his github. To sum it up, you need to read all the CSV files in a folder and write the contents of the file to the new same CSV file. I will not discuss the code itself much as required, mainly talk about the idea. In addition to the trivial requirements of using log to record execution time and valid rows, this project can be divided into three parts: Read the absolute path of all files in a folder Read the contents of a CSV file Write to the CSV file Performance improvement itself mainly can be done from two ways: First:Use Apache’s CSVPrinter If we open the CSV file with any text editor (vscode/sublime/vim), we can see that its’ difference from the .txt file is mainly that it Use , to separate objects as columns, so I used this idea to write to the CSV file at the beginning: BufferedWriter writer = null; try { Writer = new BufferedWriter(new OutputStreamWriter( New FileOutputStream(&quot;result.csv&quot;), &quot;utf-8&quot;)); } catch (IOException ex) { ex.printStackTrace(); } StringBuilder sb = new StringBuilder(); For (String item : input) { Sb.append(item); Sb.append(&quot;,&quot;); } Sb.append(&quot;\n&quot;); Writer.write(sb.toString()); But as we said, CSV is a very common file format, so there must be a library optimized for this, and CSVPrinter in the apache common CSV library is exactly what we need: Import org.apache.commons.csv.CSVPrinter; CSVPrinter writer = null; try { //initialize FileWriter object FileWriter fileWriter = new FileWriter(config.ResulF CSVFormat csvFileFormat = CSVFormat.DEFAULT.withRecordSeparator(&quot;\n&quot;); Writer = new CSVPrinter(fileWriter, csvFileFormat); } catch (IOException ex) { ex.printStackTrace(); } printer.printRecord(input); validRows += 1; Second:Change Time Processing Logic The second optimization part is mainly for the bonus point mentioned in the Assignment. Simply put, there is a string such as prefix2019/01/27suffix which needs to be converted to 2019/01/27 format that conforms to YYYY/MM/DD. In the beginning, my approach was to split string to get the value of year/month/date and then add leading zero to satisfy conversion such as “1”-&amp;gt;”01”, “12”-&amp;gt;”12” .So naturally my idea is: Month = String.format(&quot;%02d&quot;, Integer.parseInt(month)); This practice also works but it takes too long. Hundreds of files contain a total of 280,000 lines, and approach took nearly 800,000 ms. My optimization method is quite similar to an optimization technique in ACM/ICPC: Because there is only a maximum of 12 months in a total, and only 31 days in a month, as long as the conversion relationship is listed, we can use HashMap to achieve O(1) time complexity. The increase in efficiency is obvious, and the time has dropped to 4000ms. From 80000 to 4000, the program has increased incredibly 20 times! Last but not the least, there is still one way to solve it .If you search in Google: java format date string to another format, the number one link gives us the light: SimpleDateFormat format1 = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); SimpleDateFormat format2 = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;); Date date = format1.parse(&quot;2013-02-21&quot;); System.out.println(format2.format(date)); But the essence of this requirement is to complete the conversion of string-&amp;gt;string. The circle of the method above is string-&amp;gt;date-&amp;gt;date-&amp;gt;string. too tedious, isn’t it ?, so this is only a theoretical possibility, I have not adopted it.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/2019/01/27/Improve-Java-Performace-20-times-discussing-from-assignment/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Allianzcortex-Blog" href="http://localhost:4000/feed.xml">

  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="hzcortex">
  <meta name="twitter:title" content="Improve Java Project Performace 20 times ！">
  <meta name="twitter:description" content="Recently, I completed the first Assignment of Business Development. The teacher has already publish the course requirements to his github. To sum it up, you need to read all the CSV files in a fold...">
  
    <meta name="twitter:creator" content="hzcortex">
  
  

  <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Bitter:400,700,400italic:latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Allianzcortex-Blog</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
        
        <a class="page-link" href="/projects/">Projects</a>
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/board/">board</a>
      
        
        <a class="page-link" href="/feed.xml">RSS</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Improve Java Project Performace 20 times ！</h1>
    
    <p class="post-meta"><time datetime="2019-01-27T09:29:10-04:00" itemprop="datePublished">Jan 27, 2019</time> • 
  
  

</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <!-- more -->
<p>Recently, I completed the first Assignment of Business Development. The teacher has already publish the course requirements to his <a href="https://github.com/DanielPenny/MCDA5510_Assignments/blob/master/Assignment%201.pdf">github</a>.
To sum it up, <strong>you need to read all the CSV files in a folder and write the contents of the file to the new same CSV file.</strong></p>

<p>I will not discuss the code itself much as required, mainly talk about the idea.</p>

<p>In addition to the trivial requirements of using log to record execution time and valid rows, this project can be divided into three parts:</p>

<ol>
  <li>Read the absolute path of all files in a folder</li>
  <li>Read the contents of a CSV file</li>
  <li>Write to the CSV file</li>
</ol>

<p>Performance improvement itself mainly can be done from two ways:</p>

<hr />

<h4 id="firstuse-apaches-csvprinter">First:Use Apache’s CSVPrinter</h4>

<p>If we open the CSV file with any text editor (vscode/sublime/vim), we can see that its’ difference from the .txt file is mainly  that it 
Use <code class="highlighter-rouge">,</code> to separate objects as columns, so I used this idea to write to the CSV file at the beginning:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">Writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="o">(</span><span class="k">new</span> <span class="n">OutputStreamWriter</span><span class="o">(</span>
        <span class="n">New</span> <span class="nf">FileOutputStream</span><span class="o">(</span><span class="s">"result.csv"</span><span class="o">),</span> <span class="s">"utf-8"</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
<span class="n">For</span> <span class="o">(</span><span class="n">String</span> <span class="n">item</span> <span class="o">:</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="n">Sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">Sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
    <span class="n">Writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span></code></pre></figure>

<p>But as we said, CSV is a very common file format, so there must be a library optimized for this,  and CSVPrinter in the apache common CSV library is exactly what we need:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Import</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">commons</span><span class="o">.</span><span class="na">csv</span><span class="o">.</span><span class="na">CSVPrinter</span><span class="o">;</span>

<span class="n">CSVPrinter</span> <span class="n">writer</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="c1">//initialize FileWriter object
</span>
    <span class="n">FileWriter</span> <span class="n">fileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="o">(</span><span class="n">config</span><span class="o">.</span><span class="na">ResulF</span>
    <span class="n">CSVFormat</span> <span class="n">csvFileFormat</span> <span class="o">=</span> <span class="n">CSVFormat</span><span class="o">.</span><span class="na">DEFAULT</span><span class="o">.</span><span class="na">withRecordSeparator</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
    <span class="n">Writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CSVPrinter</span><span class="o">(</span><span class="n">fileWriter</span><span class="o">,</span> <span class="n">csvFileFormat</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>

<span class="n">printer</span><span class="o">.</span><span class="na">printRecord</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
<span class="n">validRows</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span></code></pre></figure>

<hr />

<h4 id="secondchange-time-processing-logic">Second:Change Time Processing Logic</h4>
<p>The second optimization part is mainly for the bonus point mentioned in the Assignment. Simply put, there is a string such as <code class="highlighter-rouge">prefix2019/01/27suffix</code> which needs to be converted to <code class="highlighter-rouge">2019/01/27</code> format that conforms to <code class="highlighter-rouge">YYYY/MM/DD</code>.</p>

<p>In the beginning, my approach was to split string to get the value of year/month/date and then add leading zero to satisfy  conversion such as “1”-&gt;”01”, “12”-&gt;”12” .So naturally my idea is:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Month = String.format("%02d", Integer.parseInt(month));
</code></pre>
</div>

<p>This practice also works but it takes too long. Hundreds of files contain a total of 280,000 lines, and  approach took nearly 800,000 ms. My optimization method is quite similar to an optimization technique in ACM/ICPC:</p>

<p>Because there is only a maximum of 12 months in a total, and only 31 days in a month, as long as the conversion relationship is listed, we can use HashMap to achieve O(1) time complexity.</p>

<p><img src="/images/playtable.PNG" alt="playtable.PNG" /></p>

<p>The increase in efficiency is obvious, and the time has dropped to 4000ms. From 80000 to 4000, the program has increased incredibly 20 times!</p>

<hr />

<p>Last but not the least, there is still one way to solve it .If you search in Google: <strong>java format date string to another format</strong>, the number one link gives us the light:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SimpleDateFormat format1 = new SimpleDateFormat("yyyy-MM-dd");
SimpleDateFormat format2 = new SimpleDateFormat("dd-MM-yyyy");
Date date = format1.parse("2013-02-21");
System.out.println(format2.format(date));
</code></pre>
</div>

<p>But the essence of this requirement is to complete the conversion of string-&gt;string. The circle of the method above is string-&gt;date-&gt;date-&gt;string. too tedious, isn’t it ?, so this is only a theoretical possibility, I have not adopted it.</p>

  </div>

</article>

        
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'allianzcortex-me'; // required: replace example with your forum shortname
        // var disqus_developer = 1; // Comment out when the site is live
        var disqus_identifier = "/2019/01/27/Improve-Java-Performace-20-times-discussing-from-assignment/";

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </main>
    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

Pro Land
    </p>

  </div>

</footer>


  </body>

</html>
